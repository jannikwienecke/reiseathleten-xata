generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch"]
}

datasource db {
  provider = "postgresql"
  url      = "postgres://admin:ztPs6uLfxoX2@ep-fragrant-base-380181-pooler.eu-central-1.aws.neon.tech/neondb?pool_timeout=20&connection_limit=10&connect_timeout=20&pgbouncer=true"
}

model AcitivityDescription {
  id                      Int                       @id @default(autoincrement())
  name                    String                    @unique
  description             String?
  fixed_hour              Int?
  fixed_minute            Int?
  fixed_day               Int?
  AcitivityTag            AcitivityTag[]
  DefaultVacationActivity DefaultVacationActivity[]
  VacationActivity        VacationActivity[]
}

model AcitivityTag {
  id                    Int                  @id @default(autoincrement())
  tagId                 Int
  activityDescriptionId Int
  AcitivityDescription  AcitivityDescription @relation(fields: [activityDescriptionId], references: [id], onDelete: Cascade)
  Tag                   Tag                  @relation(fields: [tagId], references: [id], onDelete: Cascade)
}

model Color {
  id   Int    @id @default(autoincrement())
  name String
  Tag  Tag[]
}

model Location {
  id                  Int                   @id @default(autoincrement())
  name                String                @unique
  description         String?
  VacationDescription VacationDescription[]
}

model Tag {
  id           Int            @id @default(autoincrement())
  label        String
  colorId      Int
  AcitivityTag AcitivityTag[]
  Color        Color          @relation(fields: [colorId], references: [id], onDelete: Cascade)

  @@unique([label, colorId], map: "Tag.label_colorId")
}

model User {
  id       Int        @id @default(autoincrement())
  email    String     @unique
  password String
  Customer Customer[]
  Order    Order[]
  Vacation Vacation[]
}

model Vacation {
  id                    Int                 @id @default(autoincrement())
  userId                Int
  startDate             DateTime            @default(now())
  endDate               DateTime            @default(now())
  vacationDescriptionId Int
  User                  User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  VacationDescription   VacationDescription @relation(fields: [vacationDescriptionId], references: [id], onDelete: Cascade)
  VacationActivity      VacationActivity[]
}

model VacationActivity {
  id                    Int                  @id @default(autoincrement())
  vacationId            Int
  datetime              DateTime?
  activityDescriptionId Int
  AcitivityDescription  AcitivityDescription @relation(fields: [activityDescriptionId], references: [id], onDelete: Cascade)
  Vacation              Vacation             @relation(fields: [vacationId], references: [id], onDelete: Cascade)
}

model VacationDescription {
  id                      Int                       @id @default(autoincrement())
  name                    String                    @unique
  description             String?
  image_url               String?
  locationId              Int
  DefaultVacationActivity DefaultVacationActivity[]
  Order                   Order[]
  Vacation                Vacation[]
  Location                Location                  @relation(fields: [locationId], references: [id], onDelete: Cascade)
  VacationServices        VacationServices[]
}

model DefaultVacationActivity {
  id                    Int                  @id @default(autoincrement())
  vacationDescriptionId Int
  activityDescriptionId Int
  AcitivityDescription  AcitivityDescription @relation(fields: [activityDescriptionId], references: [id], onDelete: Cascade)
  VacationDescription   VacationDescription  @relation(fields: [vacationDescriptionId], references: [id], onDelete: Cascade)
}

model Customer {
  id               Int      @id @default(autoincrement())
  first_name       String
  last_name        String
  company          String
  address_1        String
  address_2        String
  email            String   @unique
  city             String
  state            String
  postcode         String
  country          String
  phone            String
  title            String
  title_formatted  String
  shipping_address String
  birth_date       DateTime @db.Date
  user_id          Int
  User             User     @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

model Order {
  id                   Int                 @id
  order_key            String
  date_created         DateTime            @default(now()) @db.Date
  date_modified        DateTime            @default(now()) @db.Date
  date_imported        DateTime            @default(now()) @db.Date
  price                Decimal             @db.Decimal
  vacation_id          Int
  start_date           DateTime            @db.Date
  end_date             DateTime            @db.Date
  duration             Int
  persons              Int
  room_description     String
  payment_method       String
  payment_method_title String
  add_to_community     String              @default("")
  knowledge_from       String
  crossfit_box         String?
  status               String              @default("pending")
  additional_services  String              @default("")
  user_id              Int
  User                 User                @relation(fields: [user_id], references: [id], onDelete: Cascade)
  Vacation             VacationDescription @relation(fields: [vacation_id], references: [id], onDelete: NoAction)
}

model Service {
  id               Int                @id @default(autoincrement())
  name             String
  description      String             @default("")
  VacationServices VacationServices[]
}

model VacationServices {
  id          Int                 @id @default(autoincrement())
  vacation_id Int
  service_id  Int
  Service     Service             @relation(fields: [service_id], references: [id], onDelete: Cascade)
  Vacation    VacationDescription @relation(fields: [vacation_id], references: [id], onDelete: Cascade)
}
